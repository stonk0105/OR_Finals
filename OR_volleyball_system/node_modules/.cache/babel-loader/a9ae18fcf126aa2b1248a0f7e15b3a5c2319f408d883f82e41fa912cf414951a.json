{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\OR-volleyball\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport * as XLSX from 'xlsx';\nimport FileSaver from 'file-saver';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [file, setFile] = useState(null);\n  const [startDate, setStartDate] = useState('');\n  const handleFileUpload = e => {\n    const uploadedFile = e.target.files[0];\n    setFile(uploadedFile);\n  };\n  const handleGenerateSchedule = async () => {\n    if (!file || !startDate) {\n      alert(\"請上傳 Excel 並輸入開始日期！\");\n      return;\n    }\n    const data = await file.arrayBuffer();\n    const workbook = XLSX.read(data);\n    const levelSheet = XLSX.utils.sheet_to_json(workbook.Sheets['level']);\n    const refSheet = XLSX.utils.sheet_to_json(workbook.Sheets['ref_team']);\n\n    // 示例假資料\n    const generatedGroups = [{\n      Group: 'A',\n      Team: 'Team1',\n      Level: 1\n    }, {\n      Group: 'A',\n      Team: 'Team2',\n      Level: 2\n    }, {\n      Group: 'B',\n      Team: 'Team3',\n      Level: 1\n    }, {\n      Group: 'B',\n      Team: 'Team4',\n      Level: 2\n    }];\n    const schedule = generateSchedule(generatedGroups, startDate);\n    const ws = XLSX.utils.json_to_sheet(schedule);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, \"Schedule\");\n    const wbout = XLSX.write(wb, {\n      type: \"array\",\n      bookType: \"xlsx\"\n    });\n    FileSaver.saveAs(new Blob([wbout], {\n      type: \"application/octet-stream\"\n    }), \"schedule.xlsx\");\n  };\n  const generateSchedule = (groupedData, startDate) => {\n    const schedule = [];\n    const baseDate = new Date(startDate);\n    const groupGames = {};\n    groupedData.forEach(row => {\n      const group = row.Group;\n      if (!groupGames[group]) groupGames[group] = [];\n      groupGames[group].push(row.Team);\n    });\n    let currentDate = new Date(baseDate);\n    Object.entries(groupGames).forEach(([group, teams]) => {\n      const matches = [];\n      for (let i = 0; i < teams.length; i++) {\n        for (let j = i + 1; j < teams.length; j++) {\n          matches.push({\n            group,\n            teamA: teams[i],\n            teamB: teams[j]\n          });\n        }\n      }\n      matches.forEach(match => {\n        schedule.push({\n          Date: currentDate.toISOString().split('T')[0],\n          Group: match.group,\n          Match: `${match.teamA} vs ${match.teamB}`\n        });\n        currentDate.setDate(currentDate.getDate() + 1);\n      });\n    });\n    return schedule;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen flex flex-col items-center justify-center bg-stripe font-sans\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow-xl rounded-2xl p-8 w-full max-w-xl border-4 border-yellow-400 relative z-10\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-extrabold text-yellow-400 text-center mb-6\",\n        children: \"\\uD83C\\uDFD0 \\u53F0\\u5927\\u76C3\\u6392\\u7403\\u8CFD\\u7A0B\\u751F\\u6210\\u5668\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-yellow-400 font-medium mb-2\",\n          children: \"\\uD83D\\uDCC2 \\u4E0A\\u50B3 Excel \\u6A94\\u6848\\uFF1A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".xlsx\",\n          onChange: handleFileUpload,\n          className: \"w-full p-2 border-2 border-yellow-300 rounded-md bg-blue-50\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-yellow-400 font-medium mb-2\",\n          children: \"\\uD83D\\uDCC5 \\u8F38\\u5165\\u8D77\\u59CB\\u65E5\\u671F\\uFF1A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          value: startDate,\n          onChange: e => setStartDate(e.target.value),\n          className: \"w-full p-2 border-2 border-yellow-300 rounded-md bg-blue-50\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleGenerateSchedule,\n        className: \"w-full py-3 px-4 bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-bold rounded-lg transition duration-200 shadow-md\",\n        children: \"\\uD83D\\uDE80 \\u751F\\u6210\\u8CFD\\u7A0B Excel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"ps6ZbZyI+G1e6M77IUyylbnCyqg=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","XLSX","FileSaver","jsxDEV","_jsxDEV","App","_s","file","setFile","startDate","setStartDate","handleFileUpload","e","uploadedFile","target","files","handleGenerateSchedule","alert","data","arrayBuffer","workbook","read","levelSheet","utils","sheet_to_json","Sheets","refSheet","generatedGroups","Group","Team","Level","schedule","generateSchedule","ws","json_to_sheet","wb","book_new","book_append_sheet","wbout","write","type","bookType","saveAs","Blob","groupedData","baseDate","Date","groupGames","forEach","row","group","push","currentDate","Object","entries","teams","matches","i","length","j","teamA","teamB","match","toISOString","split","Match","setDate","getDate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","accept","onChange","value","onClick","_c","$RefreshReg$"],"sources":["C:/Users/User/Desktop/OR-volleyball/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport * as XLSX from 'xlsx';\nimport FileSaver from 'file-saver';\n\nfunction App() {\n  const [file, setFile] = useState(null);\n  const [startDate, setStartDate] = useState('');\n\n  const handleFileUpload = (e) => {\n    const uploadedFile = e.target.files[0];\n    setFile(uploadedFile);\n  };\n\n  const handleGenerateSchedule = async () => {\n    if (!file || !startDate) {\n      alert(\"請上傳 Excel 並輸入開始日期！\");\n      return;\n    }\n\n    const data = await file.arrayBuffer();\n    const workbook = XLSX.read(data);\n    const levelSheet = XLSX.utils.sheet_to_json(workbook.Sheets['level']);\n    const refSheet = XLSX.utils.sheet_to_json(workbook.Sheets['ref_team']);\n\n    // 示例假資料\n    const generatedGroups = [\n      { Group: 'A', Team: 'Team1', Level: 1 },\n      { Group: 'A', Team: 'Team2', Level: 2 },\n      { Group: 'B', Team: 'Team3', Level: 1 },\n      { Group: 'B', Team: 'Team4', Level: 2 },\n    ];\n\n    const schedule = generateSchedule(generatedGroups, startDate);\n\n    const ws = XLSX.utils.json_to_sheet(schedule);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, \"Schedule\");\n\n    const wbout = XLSX.write(wb, { type: \"array\", bookType: \"xlsx\" });\n    FileSaver.saveAs(new Blob([wbout], { type: \"application/octet-stream\" }), \"schedule.xlsx\");\n  };\n\n  const generateSchedule = (groupedData, startDate) => {\n    const schedule = [];\n    const baseDate = new Date(startDate);\n    const groupGames = {};\n\n    groupedData.forEach(row => {\n      const group = row.Group;\n      if (!groupGames[group]) groupGames[group] = [];\n      groupGames[group].push(row.Team);\n    });\n\n    let currentDate = new Date(baseDate);\n    Object.entries(groupGames).forEach(([group, teams]) => {\n      const matches = [];\n      for (let i = 0; i < teams.length; i++) {\n        for (let j = i + 1; j < teams.length; j++) {\n          matches.push({ group, teamA: teams[i], teamB: teams[j] });\n        }\n      }\n      matches.forEach(match => {\n        schedule.push({\n          Date: currentDate.toISOString().split('T')[0],\n          Group: match.group,\n          Match: `${match.teamA} vs ${match.teamB}`\n        });\n        currentDate.setDate(currentDate.getDate() + 1);\n      });\n    });\n\n    return schedule;\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col items-center justify-center bg-stripe font-sans\">\n      {/* 左上角單一排球 Emoji */}\n      \n\n      {/* 前景內容 */}\n      <div className=\"bg-white shadow-xl rounded-2xl p-8 w-full max-w-xl border-4 border-yellow-400 relative z-10\">\n        <h1 className=\"text-3xl font-extrabold text-yellow-400 text-center mb-6\">🏐 台大盃排球賽程生成器</h1>\n\n        <div className=\"mb-4\">\n          <label className=\"block text-yellow-400 font-medium mb-2\">📂 上傳 Excel 檔案：</label>\n          <input\n            type=\"file\"\n            accept=\".xlsx\"\n            onChange={handleFileUpload}\n            className=\"w-full p-2 border-2 border-yellow-300 rounded-md bg-blue-50\"\n          />\n        </div>\n\n        <div className=\"mb-4\">\n          <label className=\"block text-yellow-400 font-medium mb-2\">📅 輸入起始日期：</label>\n          <input\n            type=\"date\"\n            value={startDate}\n            onChange={(e) => setStartDate(e.target.value)}\n            className=\"w-full p-2 border-2 border-yellow-300 rounded-md bg-blue-50\"\n          />\n        </div>\n\n        <button\n          onClick={handleGenerateSchedule}\n          className=\"w-full py-3 px-4 bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-bold rounded-lg transition duration-200 shadow-md\"\n        >\n          🚀 生成賽程 Excel\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}